<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Trusty Build Containers for Enterprise - Travis CI</title>
<link rel="stylesheet" href="/assets/stylesheets/main.css">
<link rel="alternate" type="application/rss+xml" title="Travis CI Build Environment Updates" href="http://docs.travis-ci.com/feed.build-env-updates.xml">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js" defer></script>
<script src="/assets/javascripts/site.js" type="text/javascript" charset="utf-8" defer></script>
<script src="/assets/javascripts/main.js" type="text/javascript" charset="utf-8" defer></script>
<script src="/assets/javascripts/prism.js" type="text/javascript" charset="utf-8" defer></script>



<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24868285-6']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

  </head>
  <body>
    <div class="wrapper">

      <header class="top">
  <div class="row topbar">
    <h1 id="logo" class="logo">
  <a href="http://travis-ci.org/" title="Travis CI">Travis</a>
</h1>
    <nav>
      <ul id="navigation" class="navigation">
        <li><a href="http://blog.travis-ci.com">Blog</a></li>
        <li><a href="/">Docs</a></li>
        <li class="toggle"><button type="button" id="toggle-menu" class="button--teal">Menu</button></li>
      </ul>
    </nav>
  </div>
</header>


      <div id="content" class="row">

        <div id="sidebar" class="sidebar">
  <div>
    <!-- <h2>Search</h2> -->
    <div class="searchbox">
      <form>
        <input type="text" id="st-search-input" class="searchbox-input" placeholder="Search the docs" />
      </form>
      <script type="text/javascript">
      var Swiftype = window.Swiftype || {};
        (function() {
          Swiftype.key = 'tXvDDzd4fNTBnLvxfEyx';

      Swiftype.searchSearchFields = {
            "page": ["title, body, tags"]
          };
          Swiftype.autocompleteSearchFields = {
            "page": ["title, body, tags"]
          };
          /** DO NOT EDIT BELOW THIS LINE **/
          var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
          script.src = "//swiftype.com/embed.js";
          var entry = document.getElementsByTagName('script')[0];
          document.getElementsByTagName('script')[0].parentNode.insertBefore(script, entry);
        }());
      </script>
    </div>
  </div>

  <section class="sidebar-navigation">
    <nav>
      <h3>Travis CI Enterprise</h3>
      <ul>
        <li><a href="/user/enterprise/">About Travis CI Enterprise</a></li>
        
          <li><a href="/user/enterprise/prerequisites/">System Prerequisites</a></li>
        
          <li><a href="/user/enterprise/installation/">Installation</a></li>
        
          <li><a href="/user/enterprise/upgrading/">Upgrading</a></li>
        
          <li><a href="/user/enterprise/build-images/">Customizing Build Images</a></li>
        
          <li><a href="/user/enterprise/custom-queues/">Custom Queues</a></li>
        
          <li><a href="/user/enterprise/worker-configuration/">Worker Configuration</a></li>
        
          <li><a href="/user/enterprise/worker-cli-commands/">Worker Start & Debug Containers</a></li>
        
          <li><a href="/user/enterprise/platform-tips/">Platform Administration Tips</a></li>
        
          <li><a href="/user/enterprise/trusty/">Trusty Build Environment</a></li>
        
          <li><a href="/user/enterprise/precise/">Precise (Legacy) Build Environment</a></li>
        
          <li><a href="/user/enterprise/operations-manual/">Operations Manual</a></li>
        
      </ul>
      <h3>Travis CI Docs</h3>
      <ul>
        <li><a href="/">Travis CI Docs</a></li>
      </ul>
    </nav>
  </section>

  <section class="sidebar-notice">
    <p>This documentation site is open source.
      The <a href="https://github.com/travis-ci/docs-travis-ci-com">README in our Git repository</a> explains how to contribute.</p>
  </section>

</div><!-- /#sidebar -->


        <main id="main" class="main" data-swiftype-index='true'>
          
            <aside class="improve-page"><a href="https://github.com/travis-ci/docs-travis-ci-com/edit/master/user/enterprise/trusty.md" target="_blank" title="Edit this page on GitHub" class="button-pen" data-proofer-ignore>Improve this page on GitHub</a></aside>
            <h1 class="title">Trusty Build Containers for Enterprise</h1>
          
          <h2 id="system-setup">System Setup</h2>

<p><strong>Platform Requirements</strong>: To use the Trusty build containers, the Travis CI installation must be at 2.1.9 or higher. Please be sure to <a href="/user/enterprise/upgrading/">upgrade</a>, if needed, before getting started.</p>

<p><strong>Worker Requirements</strong>:
The Trusty worker must be running Ubuntu 14.04 LTS as an underlying operating system. We recommend using AWS’s <code class="highlighter-rouge">c3.2xlarge</code> as the instance type. Port 22 must be open for SSH during installation and operation.</p>

<p>In addition, <em>Precise build containers and Trusty build containers must be on different instances</em>. To run both Precise and Trusty builds, at least two worker instances are required.</p>

<h2 id="installation-with-travis-ci-enterprise-22">Installation with Travis CI Enterprise 2.2+</h2>

<p>Once a worker instance is up and running, <code class="highlighter-rouge">travis-worker</code> can be installed as follows:</p>

<p>For instances on AWS, please run:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -sSL -o /tmp/installer.sh https://enterprise.travis-ci.com/install/worker

sudo bash /tmp/installer.sh \
--travis_enterprise_host="[travis.yourhost.com]" \
--travis_enterprise_security_token="[RabbitMQ Password/Enterprise Security Token] \
--aws=true"
</code></pre></div></div>

<p>For non-AWS instances, please run:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -sSL -o /tmp/installer.sh https://enterprise.travis-ci.com/install/worker

sudo bash /tmp/installer.sh \
--travis_enterprise_host="[travis.yourhost.com]" \
--travis_enterprise_security_token="[RabbitMQ Password/Enterprise Security Token]"
</code></pre></div></div>

<p>This installer uses Docker’s <code class="highlighter-rouge">aufs</code> storage driver. If you have any questions or concerns, please <a href="mailto: enterprise@travis-ci.com?subject=Precise%20Workers">get in touch with us</a> to discuss alternatives.</p>

<h2 id="installation-with-travis-ci-enterprise-219">Installation with Travis CI Enterprise 2.1.9+</h2>

<p>The Travis CI Enterprise 2.1 series has the <a href="/user/enterprise/precise">Precise [Legacy]</a> as it’s default worker. However, starting with version 2.1.9+, it is possible to use Trusty build environments, assuming the feature flags are set. Otherwise, the installation process is very similar to the Enterprise 2.2 series.</p>

<h3 id="enabling-the-trusty-beta-feature-flag">Enabling the Trusty Beta Feature Flag</h3>

<ol>
  <li>SSH into the platform machine</li>
  <li>Run <code class="highlighter-rouge">travis console</code></li>
  <li>Then run <code class="highlighter-rouge">Travis::Features.enable_for_all(:template_selection); Travis::Features.enable_for_all(:multi_os)</code></li>
  <li>Type in <code class="highlighter-rouge">exit</code> to leave the console</li>
  <li>Disconnect from the Travis Enterprise platform machine</li>
</ol>

<h3 id="installation-travis-ci-enterprise-219">Installation (Travis CI Enterprise 2.1.9+)</h3>

<p>Once a worker instance is up and running, <code class="highlighter-rouge">travis-worker</code> can be installed as follows:</p>

<p>For instances on AWS, please run:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -sSL -o /tmp/installer.sh https://enterprise.travis-ci.com/install/worker

sudo bash /tmp/installer.sh \
--travis_enterprise_host="[travis.yourhost.com]" \
--travis_enterprise_security_token="[RabbitMQ Password/Enterprise Security Token] \
--aws=true"
</code></pre></div></div>

<p>For non-AWS instances, please run:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -sSL -o /tmp/installer.sh https://enterprise.travis-ci.com/install/worker

sudo bash /tmp/installer.sh \
--travis_enterprise_host="[travis.yourhost.com]" \
--travis_enterprise_security_token="[RabbitMQ Password/Enterprise Security Token]"
</code></pre></div></div>

<p>This installer uses Docker’s <code class="highlighter-rouge">aufs</code> storage driver. If you have any questions or concerns, please <a href="mailto: enterprise@travis-ci.com?subject=Precise%20Workers">get in touch with us</a> to discuss alternatives.</p>

<h3 id="running-builds-on-trusty-on-travis-ci-enterprise-219">Running builds on Trusty on Travis CI Enterprise 2.1.9+</h3>

<p>To run builds on a worker with Trusty images, please add <code class="highlighter-rouge">dist: trusty</code> to your <code class="highlighter-rouge">.travis.yml</code>. If that key is not present in your project’s <code class="highlighter-rouge">.travis.yml</code>, the build will routed to the default (Precise) build environments instead.</p>

<h2 id="restarting-travis-worker">Restarting <code class="highlighter-rouge">travis-worker</code></h2>

<p>After installation, or when configuration changes are applied to the worker, restart the worker as follows:</p>

<p><code class="highlighter-rouge">sudo service travis-worker restart</code></p>

<p>Worker configuration changes are applied on start.</p>

<h2 id="contact-enterprise-support">Contact Enterprise Support</h2>

<p>To get in touch with us, please write a message to 
<a href="mailto:enterprise@travis-ci.com">enterprise@travis-ci.com</a>. If possible, 
please include as much of the following as you can:</p>

<ul>
  <li>Description of the problem - what are you observing?</li>
  <li>Which steps did you try already?</li>
  <li>A support bundle (You can get it from <code class="highlighter-rouge">https://yourdomain:8800/support</code>)</li>
  <li>Log files from all workers (They can be found at <code class="highlighter-rouge">/var/log/upstart/travis-worker.log</code> - please include as many as you can retrieve).</li>
  <li>If a build failed or errored, a text file of the build log</li>
</ul>

<p>Have you made any customizations to your setup? While we may be able to see some 
information (such as hostname, IaaS provider, and license expiration), there 
are many other things we can’t see which could lead to something not working. 
Therefore , we’d like to ask you to also answer the questions below in your 
support request (if applicable):</p>

<ul>
  <li>How many machines are you using?</li>
  <li>Do you use configuration management tools (Chef, Puppet)?</li>
  <li>Which other services do interface with Travis CI Enterprise?</li>
  <li>Do you use Travis CI Enterprise together with github.com or GitHub Enterprise?</li>
  <li>If you’re using GitHub Enterprise, which version of it?</li>
</ul>

<p>We’re looking forward to helping!</p>


        </main>
      </div><!-- /#content -->

      <footer class="footer">
  <div class="inner row">
    <div class="footer-elem">
      <div class="travis-footer">
        <img alt="The Travis CI logo" src="/images/ui/footer-logo.svg"></div>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">&copy;Travis CI, GmbH</h3>
      <address>Rigaer Straße 8<br>10247 Berlin, Germany</address>
      <ul>
        <li><a href="https://docs.travis-ci.com/imprint.html" title="Imprint">Imprint</a></li>
        <li><a href="https://travisci.workable.com/" title="Jobs at Travis CI">Jobs</a></li>
      </ul>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">Help</h3>
      <ul>
        <li><a href="https://docs.travis-ci.com" title="Travis CI Docs">Documentation</a></li>
        <li><a href="https://blog.travis-ci.com/" title="Travis CI Blog">Blog</a></li>
        <li><a href="mailto:support@travis-ci.com" title="Email Travis CI support">Email</a></li>
        <li><a href="https://twitter.com/travisci" title="Travis CI on Twitter">Twitter</a></li>
      </ul>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">Travis CI Status</h3>
      <ul>
        <li><div class="status-circle status">Status:</div>
          <a href="http://www.traviscistatus.com/">Travis CI Status</a>
        </li>
      </ul>
    </div>
  </div>
</footer>

    </div><!-- /.wrapper -->
  </body>
</html>
