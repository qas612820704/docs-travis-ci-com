<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>S3 Deployment - Travis CI</title>
<link rel="stylesheet" href="/assets/stylesheets/main.css">
<link rel="alternate" type="application/rss+xml" title="Travis CI Build Environment Updates" href="http://docs.travis-ci.com/feed.build-env-updates.xml">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js" defer></script>
<script src="/assets/javascripts/site.js" type="text/javascript" charset="utf-8" defer></script>
<script src="/assets/javascripts/main.js" type="text/javascript" charset="utf-8" defer></script>
<script src="/assets/javascripts/prism.js" type="text/javascript" charset="utf-8" defer></script>



<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24868285-6']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

  </head>
  <body>
    <div class="wrapper">

      <header class="top">
  <div class="row topbar">
    <h1 id="logo" class="logo">
  <a href="http://travis-ci.org/" title="Travis CI">Travis</a>
</h1>
    <nav>
      <ul id="navigation" class="navigation">
        <li><a href="http://blog.travis-ci.com">Blog</a></li>
        <li><a href="/">Docs</a></li>
        <li class="toggle"><button type="button" id="toggle-menu" class="button--teal">Menu</button></li>
      </ul>
    </nav>
  </div>
</header>


      <div id="content" class="row">

        <div id="sidebar" class="sidebar">
  <div>
    <!-- <h2>Search</h2> -->
    <div class="searchbox">
      <form>
        <input type="text" id="st-search-input" class="searchbox-input" placeholder="Search the docs" />
      </form>
      <script type="text/javascript">
      var Swiftype = window.Swiftype || {};
        (function() {
          Swiftype.key = 'tXvDDzd4fNTBnLvxfEyx';

      Swiftype.searchSearchFields = {
            "page": ["title, body, tags"]
          };
          Swiftype.autocompleteSearchFields = {
            "page": ["title, body, tags"]
          };
          /** DO NOT EDIT BELOW THIS LINE **/
          var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
          script.src = "//swiftype.com/embed.js";
          var entry = document.getElementsByTagName('script')[0];
          document.getElementsByTagName('script')[0].parentNode.insertBefore(script, entry);
        }());
      </script>
    </div>
  </div>

  <section class="sidebar-navigation">
    <nav>
      <h3>Getting Started</h3>
      <ul>
        <li><a href="/user/getting-started/">Getting Started</a></li>
        <li><a href="/user/for-beginners/">Core Concepts for Beginners</a></li>
        <li><a href="/user/customizing-the-build/">Customizing Your Build</a></li>
        <li><a href="/user/common-build-problems/">Common Build Problems</a></li>
        <li><a href="/user/speeding-up-the-build/">Speeding up the Build</a></li>
        <li><a href="/user/build-stages/">Build Stages (beta)</a></li>
        <li><a href="/user/docker/">Using Docker in your Build</a></li>
        <li><a href="/user/gui-and-headless-browsers/">Headless Testing with Browsers</a></li>
        <li><a href="/user/pull-requests/">Building Pull Requests</a></li>
        <li><a href="/user/cron-jobs/">Cron Jobs</a></li>
        <li><a href="https://github.com/travis-ci/travis#readme">Command Line Client</a></li>
      </ul>

      <h3>Installing Dependencies</h3>
      <ul>
        <li><a href="/user/installing-dependencies/">Installing Dependencies</a></li>
        <li><a href="/user/private-dependencies/">Private Dependencies</a></li>
        <li><a href="/user/database-setup/">Setting up Services and Databases</a></li>
        <li><a href="/user/caching/">Caching Dependencies</a></li>
        <li><a href="/user/ssh-known-hosts/">Adding to SSH Known Hosts</a></li>

      </ul>
      <h3>Programming Languages</h3>
      <ul>
      
        <li><a href="/user/languages/android/">Android</a></li>
      
        <li><a href="/user/languages/c/">C</a></li>
      
        <li><a href="/user/languages/csharp/">C#</a></li>
      
        <li><a href="/user/languages/cpp/">C++</a></li>
      
        <li><a href="/user/languages/clojure/">Clojure</a></li>
      
        <li><a href="/user/languages/crystal/">Crystal</a></li>
      
        <li><a href="/user/languages/d/">D</a></li>
      
        <li><a href="/user/languages/dart/">Dart</a></li>
      
        <li><a href="/user/languages/erlang/">Erlang</a></li>
      
        <li><a href="/user/languages/elixir/">Elixir</a></li>
      
        <li><a href="/user/languages/csharp/">F#</a></li>
      
        <li><a href="/user/languages/go/">Go</a></li>
      
        <li><a href="/user/languages/groovy/">Groovy</a></li>
      
        <li><a href="/user/languages/haskell/">Haskell</a></li>
      
        <li><a href="/user/languages/haxe/">Haxe</a></li>
      
        <li><a href="/user/languages/java/">Java</a></li>
      
        <li><a href="/user/languages/javascript-with-nodejs/">JavaScript <small>(with Node.js)</small></a></li>
      
        <li><a href="/user/languages/julia/">Julia</a></li>
      
        <li><a href="/user/languages/nix/">Nix</a></li>
      
        <li><a href="/user/languages/objective-c/">Objective-C</a></li>
      
        <li><a href="/user/languages/perl/">Perl</a></li>
      
        <li><a href="/user/languages/perl6/">Perl6</a></li>
      
        <li><a href="/user/languages/php/">PHP</a></li>
      
        <li><a href="/user/languages/python/">Python</a></li>
      
        <li><a href="/user/languages/r/">R</a></li>
      
        <li><a href="/user/languages/ruby/">Ruby</a></li>
      
        <li><a href="/user/languages/rust/">Rust</a></li>
      
        <li><a href="/user/languages/scala/">Scala</a></li>
      
        <li><a href="/user/languages/smalltalk/">Smalltalk</a></li>
      
        <li><a href="/user/languages/objective-c/">Swift</a></li>
      
        <li><a href="/user/languages/csharp/">Visual Basic</a></li>
      
        <li><a href="/user/languages/community-supported-languages/">Adding a language</a></li>
      </ul>

      <h3>Deployments and Uploads</h3>
      <ul>
        <li class="is-overview"><a href="/user/deployment/">Overview</a></li>
        
          <li><a href="/user/deployment/anynines/">anynines</a></li>
        
          <li><a href="/user/deployment/appfog/">Appfog</a></li>
        
          <li><a href="/user/deployment/atlas/">Atlas</a></li>
        
          <li><a href="/user/deployment/codedeploy/">AWS CodeDeploy</a></li>
        
          <li><a href="/user/deployment/elasticbeanstalk/">AWS Elastic Beanstalk</a></li>
        
          <li><a href="/user/deployment/lambda/">AWS Lambda</a></li>
        
          <li><a href="/user/deployment/opsworks/">AWS OpsWorks</a></li>
        
          <li><a href="/user/deployment/s3/">AWS S3</a></li>
        
          <li><a href="/user/deployment/azure-web-apps/">Azure Web Apps</a></li>
        
          <li><a href="/user/deployment/bintray/">bintray</a></li>
        
          <li><a href="/user/deployment/bitballoon/">BitBalloon</a></li>
        
          <li><a href="/user/deployment/bluemixcloudfoundry/">Bluemix CloudFoundry</a></li>
        
          <li><a href="/user/deployment/boxfuse/">Boxfuse</a></li>
        
          <li><a href="/user/deployment/catalyze/">Catalyze</a></li>
        
          <li><a href="/user/deployment/chefsupermarket/">Chef Supermarket</a></li>
        
          <li><a href="/user/deployment/cloud66/">Cloud 66</a></li>
        
          <li><a href="/user/deployment/cloudfoundry/">CloudFoundry</a></li>
        
          <li><a href="/user/deployment/deis/">Deis</a></li>
        
          <li><a href="/user/deployment/engineyard/">Engine Yard</a></li>
        
          <li><a href="/user/deployment/pages/">GitHub Pages</a></li>
        
          <li><a href="/user/deployment/releases/">GitHub Releases</a></li>
        
          <li><a href="/user/deployment/google-app-engine/">Google App Engine</a></li>
        
          <li><a href="/user/deployment/gcs/">Google Cloud Storage</a></li>
        
          <li><a href="/user/deployment/firebase/">Google Firebase</a></li>
        
          <li><a href="/user/deployment/hackage/">Hackage</a></li>
        
          <li><a href="/user/deployment/heroku/">Heroku</a></li>
        
          <li><a href="/user/deployment/launchpad/">Launchpad</a></li>
        
          <li><a href="/user/deployment/modulus/">Modulus</a></li>
        
          <li><a href="/user/deployment/npm/">npm</a></li>
        
          <li><a href="/user/deployment/openshift/">OpenShift</a></li>
        
          <li><a href="/user/deployment/packagecloud/">packagecloud.io</a></li>
        
          <li><a href="/user/deployment/puppetforge/">Puppet Forge</a></li>
        
          <li><a href="/user/deployment/pypi/">PyPI</a></li>
        
          <li><a href="/user/deployment/cloudfiles/">Rackspace Cloud Files</a></li>
        
          <li><a href="/user/deployment/rubygems/">RubyGems</a></li>
        
          <li><a href="/user/deployment/scalingo/">Scalingo</a></li>
        
          <li><a href="/user/deployment/script/">Script</a></li>
        
          <li><a href="/user/deployment/surge/">Surge.sh</a></li>
        
          <li><a href="/user/deployment/testfairy/">TestFairy</a></li>
        
          <li><a href="/user/deployment/snaps/">Ubuntu Snap Store</a></li>
        
        <li><a href="/user/uploading-artifacts/">Uploading Build Artifacts</a></li>
      </ul>

      <h3>CI Environment Reference</h3>
      <ul>
      <li class="is-overview"><a href="/user/reference/overview/">Overview</a></li>
      <li><a href="/user/reference/precise/">Precise CI Environment Reference</a></li>
      <li><a href="/user/reference/trusty/">Trusty CI Environment</a><li>
      <li><a href="/user/reference/osx/">OS X CI Environment Reference</a></li>
      <li><a href="/user/multi-os/">Building on Multiple Operating Systems</a></li>
      <li><a href="/user/environment-variables/">Environment Variables</a></li>
      <li><a href="/user/precise-to-trusty-migration-guide/">Precise to Trusty Migration Guide</a></li>
      <li><a href="/user/build-environment-updates/">Build Environment Updates</a></li>
      <li><a href="/user/ip-addresses/">Build machines IP Addresses</a></li>
      </ul>

      <h3>Encrypting Files and Data</h3>
      <ul>
        <li><a href="/user/encryption-keys/">Encrypting Sensitive Data</a></li>
        <li><a href="/user/encrypting-files/">Encrypting Files</a></li>
        <li><a href="/user/github-oauth-scopes/">GitHub Permissions used by Travis CI</a></li>
        <li><a href="/user/best-practices-security/">Best Practices in Securing Your Data</a></li>
      </ul>

      <h3>Beta Features</h3>
      <ul>
        <li><a href="/user/build-stages/">Build Stages</a></li>
        <li><a href="/user/conditional-builds-stages-jobs/">Conditional Builds, Stages, and Jobs</a></li>
      </ul>

      <h3>Integrations and Notifications</h3>
      <ul>
        <li><a href="/user/notifications/">Configuring Notifications</a></li>
        <li><a href="/user/status-images/">Showing Build Status Images</a></li>
        <li><a href="/user/code-climate/">Code Climate</a></li>
        <li><a href="/user/coveralls/">Coveralls</a></li>
        <li><a href="/user/coverity-scan/">Coverity Scan</a></li>
        <li><a href="/user/browserstack/">BrowserStack</a></li>
        <li><a href="/user/sauce-connect/">Sauce Labs</a></li>
        <li><a href="/user/sonarcloud/">SonarCloud</a></li>
        <li><a href="/user/sourceclear/">SourceClear</a></li>
        <li><a href="/user/build-feeds/">Atom Feeds</a></li>
        <li><a href="/user/cc-menu/">CCMenu / CCTray Feeds</a></li>
        <li><a href="/user/integration/platformio/">Embedded Builds with PlatformIO</a></li>
      </ul>

      <h3>Developer Program</h3>
      <ul>
        <li class="is-overview"><a href="/user/developer/">Overview</a></li>
        <li><a href="http://developer.travis-ci.com/">API V3</a></li>
        <li><a href="/user/triggering-builds/">Triggering Builds with API V3</a></li>
        <li><a href="https://github.com/travis-ci/travis#ruby-library">The Ruby Library</a></li>
      </ul>
      <h3>3rd Party Tools and Resources</h3>
      <ul>
        <li><a href="/user/apps/">Apps, Clients and Tools</a></li>
        <li><a href="https://scan.coverity.com/travis_ci">Coverity Scan</a></li>
      </ul>
      <h3>Travis CI Enterprise</h3>
      <ul>
        <li><a href="/user/enterprise/">Enterprise Docs</a></li>
      </ul>
      <h3>Legal</h3>
      <ul>
        <li><a href="/legal/security/">Security</a></li>
        <li><a href="/legal/terms-conditions/">Terms and Conditions</a></li>
      </ul>
    </nav>
  </section>

  <section class="sidebar-notice">
    <p>This documentation site is open source.
      The <a href="https://github.com/travis-ci/docs-travis-ci-com">README in our Git repository</a> explains how to contribute.</p>
  </section>

</div><!-- /#sidebar -->


        <main id="main" class="main" data-swiftype-index='true'>
          
            <aside class="improve-page" data-swiftype-index='false'><a href="https://github.com/travis-ci/docs-travis-ci-com/edit/master/user/deployment/s3.md" target="_blank" title="Edit this page on GitHub" class="button-pen" data-proofer-ignore>Improve this page on GitHub</a></aside>
            <h1 class="title">S3 Deployment</h1>
          
          <div id="toc"></div>

<p>Travis CI can automatically upload your build to Amazon S3 after a successful build.</p>

<p>For a minimal configuration, add the following to your <code class="highlighter-rouge">.travis.yml</code>:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">s3</span>
  <span class="na">access_key_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">ACCESS</span><span class="nv"> </span><span class="s">KEY"</span>
  <span class="na">secret_access_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">SECRET</span><span class="nv"> </span><span class="s">KEY"</span>
  <span class="na">bucket</span><span class="pi">:</span> <span class="s2">"</span><span class="s">S3</span><span class="nv"> </span><span class="s">Bucket"</span>
</code></pre></div></div>

<p>You can find your <a href="https://console.aws.amazon.com/iam/home?#security_credential">AWS Access Keys</a> in your Amazon Console. You should probably encrypt the secret key with the Travis CI command line:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>travis encrypt <span class="nt">--add</span> deploy.secret_access_key
</code></pre></div></div>

<p>The previous example is almost certainly not ideal, as you probably want to upload your built binaries and documentation. Set <code class="highlighter-rouge">skip_cleanup</code> to <code class="highlighter-rouge">true</code> to prevent Travis CI from deleting your build artifacts.</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">s3</span>
  <span class="na">access_key_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">ACCESS</span><span class="nv"> </span><span class="s">KEY"</span>
  <span class="na">secret_access_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">SECRET</span><span class="nv"> </span><span class="s">KEY"</span>
  <span class="na">bucket</span><span class="pi">:</span> <span class="s2">"</span><span class="s">S3</span><span class="nv"> </span><span class="s">Bucket"</span>
  <span class="na">skip_cleanup</span><span class="pi">:</span> <span class="no">true</span>
</code></pre></div></div>

<blockquote>
  <p>Note that deploying to S3 only adds files to your bucket, it does not remove them. If you need to remove deprecated files you can do that manually in your Amazon S3 console.</p>
</blockquote>

<p>Instead of adding your Amazon S3 configuration to your <code class="highlighter-rouge">.travis.yml</code> you can run the Travis CI command line in your project directory to set it up:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>travis setup s3
</code></pre></div></div>

<p>Keep in mind that the above command has to run in your project directory, so it can modify the <code class="highlighter-rouge">.travis.yml</code> for you.</p>

<h2 id="s3-acl-via-option">S3 ACL via option</h2>

<p>You can set the acl of your uploaded files via the <code class="highlighter-rouge">acl</code> option like this:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">s3</span>
  <span class="na">access_key_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">ACCESS</span><span class="nv"> </span><span class="s">KEY"</span>
  <span class="na">secret_access_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">SECRET</span><span class="nv"> </span><span class="s">KEY"</span>
  <span class="na">bucket</span><span class="pi">:</span> <span class="s2">"</span><span class="s">S3</span><span class="nv"> </span><span class="s">Bucket"</span>
  <span class="na">skip_cleanup</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">acl</span><span class="pi">:</span> <span class="s">public_read</span>
</code></pre></div></div>

<p>Valid ACL values are: <code class="highlighter-rouge">private</code>, <code class="highlighter-rouge">public_read</code>, <code class="highlighter-rouge">public_read_write</code>, <code class="highlighter-rouge">authenticated_read</code>, <code class="highlighter-rouge">bucket_owner_read</code>, <code class="highlighter-rouge">bucket_owner_full_control</code>. The ACL defaults to <code class="highlighter-rouge">private</code>.</p>

<p>Note that, in order to set <code class="highlighter-rouge">acl</code>, the bucket’s policy must allow such operations via the <code class="highlighter-rouge">s3:PutObjectAcl</code> action.
An example policy might look like this:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"Sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AllowPublicRead"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PRINCIPAL_ID"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"Action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"s3:AbortMultipartUpload"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"s3:DeleteObject"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"s3:GetObject"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"s3:GetObjectAcl"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"s3:PutObject"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"s3:PutObjectAcl"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="s2">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::BUCKET_NAME/*"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Be sure to set up the principal and resources according to your needs.</p>

<h2 id="s3-acl-with-bucket-policy">S3 ACL with bucket policy</h2>

<p>Another way to set ACL for your artifacts is via a S3 bucket policy.</p>

<p>This bucket policy grants the public read permission:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-09-25"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Statement"</span><span class="p">:[{</span><span class="w">
    </span><span class="s2">"Sid"</span><span class="p">:</span><span class="s2">"AllowPublicRead"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Effect"</span><span class="p">:</span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"Action"</span><span class="p">:[</span><span class="s2">"s3:GetObject"</span><span class="p">],</span><span class="w">
      </span><span class="s2">"Resource"</span><span class="p">:[</span><span class="s2">"arn:aws:s3:::"</span><span class="err">YOUR</span><span class="w"> </span><span class="err">BUCKET</span><span class="w"> </span><span class="err">NAME</span><span class="s2">"/*"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="s3-bucket-regions">S3 bucket regions</h2>

<p>By default the region <code class="highlighter-rouge">us-east-1</code> is used when deploying to S3. If your bucket is hosted in a different region, deploying using the default region results in the following error.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The bucket you are attempting to access must be addressed using the specified endpoint.
Please send all future requests to this endpoint. (AWS::S3::Errors::PermanentRedirect)
</code></pre></div></div>

<p>This can be resolved by specifying your bucket’s region using the <code class="highlighter-rouge">region</code> configuration. For example, this example uses the <code class="highlighter-rouge">eu-west-1</code> region.</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">s3</span>
  <span class="na">access_key_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">ACCESS</span><span class="nv"> </span><span class="s">KEY"</span>
  <span class="na">secret_access_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">SECRET</span><span class="nv"> </span><span class="s">KEY"</span>
  <span class="na">bucket</span><span class="pi">:</span> <span class="s2">"</span><span class="s">S3</span><span class="nv"> </span><span class="s">Bucket"</span>
  <span class="na">skip_cleanup</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">region</span><span class="pi">:</span> <span class="s">eu-west-1</span>
</code></pre></div></div>

<h2 id="deploy-from-only-one-folder">Deploy From Only One Folder</h2>

<p>Often, you don’t want to upload your entire project to S3. You can tell Travis CI to only upload a single folder to S3. You can use the <code class="highlighter-rouge">local_dir</code> option to do so. This example uploads the <code class="highlighter-rouge">build</code> directory of your project to S3:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">s3</span>
  <span class="na">access_key_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">ACCESS</span><span class="nv"> </span><span class="s">KEY"</span>
  <span class="na">secret_access_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">SECRET</span><span class="nv"> </span><span class="s">KEY"</span>
  <span class="na">bucket</span><span class="pi">:</span> <span class="s2">"</span><span class="s">S3</span><span class="nv"> </span><span class="s">Bucket"</span>
  <span class="na">skip_cleanup</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">local_dir</span><span class="pi">:</span> <span class="s">build</span>
</code></pre></div></div>

<h2 id="deploy-to-a-specific-s3-folder">Deploy to a Specific S3 Folder</h2>

<p>Often, you want to upload only to a specific S3 Folder. You can use the <code class="highlighter-rouge">upload-dir</code> option to set the S3 destination folder. This example uploads to the <code class="highlighter-rouge">travis-builds</code> folder of your s3 bucket.</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">s3</span>
  <span class="na">access_key_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">ACCESS</span><span class="nv"> </span><span class="s">KEY"</span>
  <span class="na">secret_access_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">SECRET</span><span class="nv"> </span><span class="s">KEY"</span>
  <span class="na">bucket</span><span class="pi">:</span> <span class="s2">"</span><span class="s">S3</span><span class="nv"> </span><span class="s">Bucket"</span>
  <span class="na">skip_cleanup</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">upload-dir</span><span class="pi">:</span> <span class="s">travis-builds</span>
</code></pre></div></div>

<h2 id="deploy-to-a-s3-hosted-website">Deploy to a S3 hosted website:</h2>

<p>To upload to a S3 hosted website, to use this template to upload to your website.</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">s3</span>
  <span class="na">access_key_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">ACCESS</span><span class="nv"> </span><span class="s">KEY"</span>
  <span class="na">secret_access_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">SECRET</span><span class="nv"> </span><span class="s">KEY"</span>
  <span class="na">bucket</span><span class="pi">:</span> <span class="s2">"</span><span class="s">S3</span><span class="nv"> </span><span class="s">Bucket"</span>
  <span class="na">skip_cleanup</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">region</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Bucket</span><span class="nv"> </span><span class="s">region"</span>
</code></pre></div></div>

<p>Remember that you need to set the bucket to have an ACL of <code class="highlighter-rouge">public</code> for anybody to be able to see your website.</p>

<h2 id="deploy-to-multiple-buckets">Deploy to Multiple Buckets:</h2>

<p>If you want to upload to multiple buckets, you can do this:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">provider</span><span class="pi">:</span> <span class="s">s3</span>
    <span class="na">access_key_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">ACCESS</span><span class="nv"> </span><span class="s">KEY"</span>
    <span class="na">secret_access_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">SECRET</span><span class="nv"> </span><span class="s">KEY"</span>
    <span class="na">bucket</span><span class="pi">:</span> <span class="s2">"</span><span class="s">S3</span><span class="nv"> </span><span class="s">Bucket"</span>
    <span class="na">skip_cleanup</span><span class="pi">:</span> <span class="no">true</span>
  <span class="pi">-</span> <span class="na">provider</span><span class="pi">:</span> <span class="s">s3</span>
    <span class="na">access_key_id</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">ACCESS</span><span class="nv"> </span><span class="s">KEY"</span>
    <span class="na">secret_access_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">AWS</span><span class="nv"> </span><span class="s">SECRET</span><span class="nv"> </span><span class="s">KEY"</span>
    <span class="na">bucket</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Second</span><span class="nv"> </span><span class="s">S3</span><span class="nv"> </span><span class="s">Bucket"</span>
    <span class="na">skip_cleanup</span><span class="pi">:</span> <span class="no">true</span>
</code></pre></div></div>

<h2 id="conditional-releases">Conditional releases</h2>

<p>You can deploy only when certain conditions are met.
See <a href="/user/deployment#Conditional-Releases-with-on%3A">Conditional Releases with <code class="highlighter-rouge">on:</code></a>.</p>

<h2 id="running-commands-before-and-after-release">Running commands before and after release</h2>

<p>Sometimes you want to run commands before or after releasing a gem. You can use the <code class="highlighter-rouge">before_deploy</code> and <code class="highlighter-rouge">after_deploy</code> stages for this. These will only be triggered if Travis CI is actually pushing a release.</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="na">before_deploy</span><span class="pi">:</span> <span class="s2">"</span><span class="s">echo</span><span class="nv"> </span><span class="s">'ready?'"</span>
    <span class="na">deploy</span><span class="pi">:</span>
      <span class="s">..</span>
    <span class="na">after_deploy</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./after_deploy_1.sh</span>
      <span class="pi">-</span> <span class="s">./after_deploy_2.sh</span>
</code></pre></div></div>

<h2 id="setting-content-encoding-header">Setting <code class="highlighter-rouge">Content-Encoding</code> header</h2>

<p>S3 uploads can optionally set HTTP header <code class="highlighter-rouge">Content-Encoding</code>.
This header allows files to be sent compressed while retaining file extensions and
the associated MIME types.</p>

<p>To enable this feature, add:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">s3</span>
  <span class="s">..</span>
  <span class="na">detect_encoding</span><span class="pi">:</span> <span class="no">true</span> <span class="c1"># &lt;== default is false</span>
</code></pre></div></div>

<p>If the file is compressed with <code class="highlighter-rouge">gzip</code> or <code class="highlighter-rouge">compress</code>, it will be uploaded with
the appropriate header.</p>

<h2 id="setting-charset-on-content-type-header">Setting <code class="highlighter-rouge">charset</code> on <code class="highlighter-rouge">Content-Type</code> header</h2>

<p>S3 can take a content-type header. Normally this doesn’t include a character set as well. If you would like to add a character set, add the <code class="highlighter-rouge">default_text_charset</code> option with what you want it to be. For example:</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">s3</span>
  <span class="s">..</span>
  <span class="na">default_text_charset</span><span class="pi">:</span> <span class="s1">'</span><span class="s">utf-8'</span>  <span class="c1"># Default is ''</span>
</code></pre></div></div>

<h2 id="http-cache-control">HTTP cache control</h2>

<p>S3 uploads can optionally set  <code class="highlighter-rouge">Cache-Control</code> and <code class="highlighter-rouge">Expires</code> HTTP headers.</p>

<p>Set HTTP header <code class="highlighter-rouge">Cache-Control</code> to suggest that the browser cache the file. Defaults to <code class="highlighter-rouge">no-cache</code>. Valid options are <code class="highlighter-rouge">no-cache</code>, <code class="highlighter-rouge">no-store</code>, <code class="highlighter-rouge">max-age=&lt;seconds&gt;</code>, <code class="highlighter-rouge">s-maxage=&lt;seconds&gt; no-transform</code>, <code class="highlighter-rouge">public</code>, <code class="highlighter-rouge">private</code>.</p>

<p><code class="highlighter-rouge">Expires</code> sets the date and time that the cached object is no longer cacheable. Defaults to not set. The date must be in the format <code class="highlighter-rouge">YYYY-MM-DD HH:MM:SS -ZONE</code>.</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">s3</span>
  <span class="s">..</span>
  <span class="na">cache_control</span><span class="pi">:</span> <span class="s2">"</span><span class="s">max-age=31536000"</span>
  <span class="na">expires</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2012-12-21</span><span class="nv"> </span><span class="s">00:00:00</span><span class="nv"> </span><span class="s">-0000"</span>
</code></pre></div></div>

<h3 id="using-s3-compatible-object-storage">Using S3-compatible Object Storage</h3>

<p>You can use an S3-compatible object storage such as Digital Ocean Spaces
by setting the <code class="highlighter-rouge">endpoint</code> key.</p>

<div data-file=".travis.yml" class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">s3</span>
  <span class="s">..</span>
  <span class="na">endpoint</span><span class="pi">:</span> <span class="s">https://nyc3.digitaloceanspaces.com</span>
</code></pre></div></div>

        </main>
      </div><!-- /#content -->

      <footer class="footer">
  <div class="inner row">
    <div class="footer-elem">
      <div class="travis-footer">
        <img alt="The Travis CI logo" src="/images/ui/footer-logo.svg"></div>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">&copy;Travis CI, GmbH</h3>
      <address>Rigaer Straße 8<br>10247 Berlin, Germany</address>
      <ul>
        <li><a href="https://docs.travis-ci.com/imprint.html" title="Imprint">Imprint</a></li>
        <li><a href="https://travisci.workable.com/" title="Jobs at Travis CI">Jobs</a></li>
      </ul>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">Help</h3>
      <ul>
        <li><a href="https://docs.travis-ci.com" title="Travis CI Docs">Documentation</a></li>
        <li><a href="https://blog.travis-ci.com/" title="Travis CI Blog">Blog</a></li>
        <li><a href="mailto:support@travis-ci.com" title="Email Travis CI support">Email</a></li>
        <li><a href="https://twitter.com/travisci" title="Travis CI on Twitter">Twitter</a></li>
      </ul>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">Travis CI Status</h3>
      <ul>
        <li><div class="status-circle status">Status:</div>
          <a href="http://www.traviscistatus.com/">Travis CI Status</a>
        </li>
      </ul>
    </div>
  </div>
</footer>

    </div><!-- /.wrapper -->
  </body>
</html>
